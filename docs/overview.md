# 新幹線予約システム 概要（overview）

## 1. システムの目的

Ruby on Rails を用いて開発する新幹線予約システム。  
利用者・駅員・運行管理者の3つのロールを持ち、便検索から座席予約、発券管理、運行管理までを扱う。

---

## 2. 対象区間・駅構成

### 駅一覧（順序固定・全17駅）

東京 / 品川 / 新横浜 / 小田原 / 熱海 / 三島 / 新富士 / 静岡 / 掛川 / 浜松 /  
豊橋 / 三河安城 / 名古屋 / 岐阜羽島 / 米原 / 京都 / 新大阪

※ 上り・下り判定は駅インデックスの大小関係で行う。

---

## 3. 列車種別と停車ルール

- **のぞみ**：東京・品川・新横浜・名古屋・京都・新大阪
- **ひかり**：東京・品川・新横浜・静岡・浜松・名古屋・京都・新大阪
- **こだま**：全駅停車

※ 停車駅は列車種別ごとに固定。

---

## 4. 座席・席種仕様

### 席種と構成

- **指定席**：2,3,6–8号車（8行 × 5列）
- **グリーン車**：4,5号車（8行 × 4列）
- **ファビュラスルーム**：1号車（6室）

### 予約上限

- 指定席・グリーン車：1予約につき最大6席
- ファビュラスルーム：1予約につき1室

---

## 5. 残席表示ルール

### 指定席・グリーン車

- 20席以上：◎
- 7〜19席：◯
- 1〜6席：△（残席数を表示）
- 0席：×（選択不可）

### ファビュラスルーム

- 5〜6室：◎
- 3〜4室：◯
- 1〜2室：△（残室数を表示）
- 0室：×（選択不可）

---

## 6. 検索・予約に関する制約

### 検索制約

- 発駅と着駅が同一の場合は不可
- 過去の日付・時刻は不可
- 本日から15日以降の便は検索不可

### 予約制約

- 未ログイン状態では予約不可
- 席を1つ以上選択しないと予約確認画面に進めない
- 同一席でも区間が異なれば予約は可能

---

## 7. 会員・権限モデル

### 利用者
- 会員登録・ログイン
- 便検索・予約
- 自身の未発券予約のみ削除可能

### 駅員

- 代理予約の実行
- 全利用者の未発券予約を削除可能
- 利用者検索（氏名・ログインID）

### 運行管理者

- 便の追加・管理
- 予約操作は不可（予約情報は閲覧しない）

---

## 8. 会員情報のルール

### ログインID

- 英数字とアンダーバーのみ
- 6〜20文字
- 重複不可・空欄不可
- 登録後は変更不可

### パスワード

- 大文字・小文字・数字・指定記号（@, ¥, !, $, &）をすべて含む
- 6〜20文字
- 空欄不可

### 氏名

- 20文字以下
- 空欄不可
- 同姓同名の登録を許可

---

## 9. 発券状態と削除ルール

- **未発券**：利用者・駅員ともに削除可能
- **発券済み**：削除不可
- 発券済みを未発券に戻すことは不可
- 予約削除は席単位ではなく予約単位で行う

---

## 10. シードデータ前提（開発・テスト用）

- 特定時刻・種別の便を事前投入
- 満席便・一部予約済み便を含む

※ 詳細なテスト手順・ケースは `docs/test.md` および外部スプレッドシートに記載する。
