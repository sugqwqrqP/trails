<h1>Runs#index</h1>

<div class="banner">
</div>

<%= form_with url: runs_path, method: :get, local: true do |f| %>

  <!-- 乗車駅 -->
  <div>
    <%= f.label :from_station_id, "乗車駅" %>
    <%= f.collection_select :from_station_id,
          Station.order(:station_order),
          :id,
          :station_name,
          {
            prompt: "選択してください",
            selected: params[:from_station_id]
          } %>
  </div>

  <!-- 降車駅 -->
  <div>
    <%= f.label :to_station_id, "降車駅" %>
    <%= f.collection_select :to_station_id,
          Station.order(:station_order),
          :id,
          :station_name,
          {
            prompt: "選択してください",
            selected: params[:to_station_id]
          } %>
  </div>

  <!-- 日付 -->
  <div>
    <%= f.label :run_on, "日付" %>
    <%= f.date_field :run_on, value: params[:run_on] %>
  </div>

  <!-- 時刻 -->
  <div>
    <%= f.label :time, "時間" %>
    <%= f.time_field :time, value: params[:time] %>
  </div>

  <!-- 時刻基準 -->
  <div>
    <%= f.label :time_basis, "基準" %>
    <%= f.select :time_basis,
          [["出発時間", "departure"], ["到着時間", "arrival"]],
          selected: params[:time_basis] %>
  </div>

  <%= f.submit "検索" %>

<% end %>

<% @results.each do |result| %>
  <% run = result[:run] %>

  <div style="margin-bottom: 12px; padding: 8px; border: 1px solid #ddd;">
    <div>
      <strong><%= run.name %></strong>
      （
        <%= run.run_on %>
        <%= result[:departure_time].strftime("%H:%M") %>
        →
        <%= result[:arrival_time].strftime("%H:%M") %>
        ／ 所要 <%= result[:travel_min] %>分
      ）
    </div>

    <!-- 空席状況（ダミー） -->
    <div>
      指定席: ○　グリーン: ◎　ファビュラスルーム: ○
    </div>

    <!-- 号車マップへ -->
    <div>
      <%= link_to "号車選択へ", run_cars_path(run) %>
    </div>
  </div>
<% end %>
